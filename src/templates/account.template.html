{%TEMPLATE->struct/head%}
{%TEMPLATE->struct/menu%}
<h2>My Account ([[htmlentities([[user.getUsername()]], ENT_QUOTES, "UTF-8")]])</h2>
{%TEMPLATE->struct/messages%}
<div class="card">
  <div class="table-responsive">
    <table class="table table-bordered">
		  <tr>
			  <th>用户类型</th>
			  <td>
				  [[group.getGroupName()]]
			  </td>
		  </tr>
		  <tr>
			  <th>注册日期</th>
			  <td>
				  [[date([[config.getVal(DConfig::TIME_FORMAT)]], [[user.getRegisteredSince()]])]]
			  </td>
		  </tr>
		  <tr>
			  <th>Email 地址</th>
			  <td>
				  <form class='form-inline' action="account.php" method="post">
					  <input type='hidden' name='action' value='[[$DAccountAction::SET_EMAIL]]'>
					  <input type='email' name='email' class='form-control' value='[[user.getEmail()]]' title="Email">&nbsp;&nbsp;
					  <input type="hidden" name="csrf" value="[[csrf]]">
            <button type="submit" class='btn btn-light' data-toggle="tooltip" data-placement="top" title="Set"><i class="fas fa-save" aria-hidden="true"></i></button>
				  </form>
			  </td>	
		  </tr>
		  <tr>
			  <th>设置session存活时间</th>
			  <td>
				  <form class='form-inline' action="account.php" method="post">
					  <input type='hidden' name='action' value='[[$DAccountAction::UPDATE_LIFETIME]]'>
					  <input type='text' name='lifetime' class='form-control' value='[[user.getSessionLifetime()]]' title="Session Length">&nbsp; 秒 &nbsp;
					  <input type="hidden" name="csrf" value="[[csrf]]">
            <button type="submit" class='btn btn-light' data-toggle="tooltip" data-placement="top" title="Set"><i class="fas fa-save" aria-hidden="true"></i></button>
				  </form>
			  </td>	
		  </tr>
		  <tr>
			  <th>密码</th>
			  <td>
				  <form class='form-inline' action="account.php" method="post">
					  <input type='hidden' name='action' value='[[$DAccountAction::CHANGE_PASSWORD]]'>
					  <input type='password' name='oldpass' class='form-control' placeholder='旧密码...'>&nbsp;&nbsp;
					  <input type='password' name='newpass' class='form-control' placeholder='新密码...'>&nbsp;&nbsp;
					  <input type='password' name='reppass' class='form-control' placeholder='重复密码...'>&nbsp;&nbsp;
					  <input type="hidden" name="csrf" value="[[csrf]]">
					  <input type="submit" class='btn btn-light' value="Change Password">
				  </form>
			  </td>
		  </tr>
	  </table>
  </div>
</div>
<div class="card">
  <div class="table-responsive">
    <table class="table table-bordered">
		  <tr>
			  <td colspan="2">
				  <div class="alert alert-warning">
					  <b>Disclaimer:</b> Administrators cannot reset your OTP auth information if your key is lost.
				  </div>
			  </td>
		  </tr>
		  {{IF ![[Util::isYubikeyEnabled()]]}}
			  <tr>
				  <th>Yubikey OTP</th>
				  <td>
					  Yubikey is currently not configured.<br>
					  Please contact an admin as it needs to be enabled and set up on the server configuration.
				  </td>
			  </tr>
		  {{ELSE}}
			  <tr>
				  <th>Enable/Disable Yubikey OTP</th>
					  <td>
						  {{IF [[user.getYubikey()]] == 1}}
							  <form class='form-inline' action="account.php" method="post">
								  Yubikey OTP currently enabled
								  <input type='hidden' name='action' value='[[$DAccountAction::YUBKEY_DISABLE]]'>
								  <input type="hidden" name="csrf" value="[[csrf]]">
								  <input type="submit" class='btn btn-warning' value="Disable">
							  </form>
						  {{ELSE}}
							  <form class='form-inline' action="account.php" method="post">
								  Yubikey OTP is currently disabled
								  <input type='hidden' name='action' value='[[$DAccountAction::YUBKEY_ENABLE]]'>
								  <input type="hidden" name="csrf" value="[[csrf]]">
								  <input type="submit" class='btn btn-success' value="Enable">
							  </form>
						  {{ENDIF}}
					  </td>
			  </tr>
			  <tr>
				  <th>OTP KEY 1:</th>
				  <td>
					  <form class='form-inline' action="account.php" method="post">
						  <input type='hidden' name='action' value='[[$DAccountAction::SET_OTP1]]'>
						  <input type='text' name='otp1' class='form-control' value='[[user.getOtp1()]]' title="OTP Key">&nbsp;&nbsp;
						  <input type="hidden" name="csrf" value="[[csrf]]">
						  <input type="submit" class='btn btn-light' value="Update">
					  </form>
				  </td>
			  </tr>
			  <tr>
				  <th>OTP KEY 2:</th>
				  <td>
					  <form class='form-inline' action="account.php" method="post">
						  <input type='hidden' name='action' value='[[$DAccountAction::SET_OTP2]]'>
						  <input type='text' name='otp2' class='form-control' value='[[user.getOtp2()]]' title="OTP Key">&nbsp;&nbsp;
						  <input type="hidden" name="csrf" value="[[csrf]]">
						  <input type="submit" class='btn btn-light' value="Update">
					  </form>
				  </td>
			  </tr>
			  <tr>
				  <th>OTP KEY 3:</th>
				  <td>
					  <form class='form-inline' action="account.php" method="post">
						  <input type='hidden' name='action' value='[[$DAccountAction::SET_OTP3]]'>
						  <input type='text' name='otp3' class='form-control' value='[[user.getOtp3()]]' title="OTP Key">&nbsp;&nbsp;
						  <input type="hidden" name="csrf" value="[[csrf]]">
						  <input type="submit" class='btn btn-light' value="Update">
					  </form>
				  </td>
			  </tr>
			  <tr>
				  <th>OTP KEY 4:</th>
				  <td>
					  <form class='form-inline' action="account.php" method="post">
						  <input type='hidden' name='action' value='[[$DAccountAction::SET_OTP4]]'>
						  <input type='text' name='otp4' class='form-control' value='[[user.getOtp4()]]' title="OTP Key">&nbsp;&nbsp;
						  <input type="hidden" name="csrf" value="[[csrf]]">
						  <input type="submit" class='btn btn-light' value="Update">
					  </form>
				  </td>
			  </tr>
		  {{ENDIF}}
	  </table>
  </div>
</div>
{%TEMPLATE->struct/foot%}
